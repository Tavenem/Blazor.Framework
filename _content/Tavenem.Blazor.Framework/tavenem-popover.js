const t={top:{"top-left":"bottom-left","top-center":"bottom-center","anchor-bottom-center":"anchor-top-center","top-right":"bottom-right"},left:{"top-left":"top-right","center-left":"center-right","anchor-center-right":"anchor-center-left","bottom-left":"bottom-right"},right:{"top-right":"top-left","center-right":"center-left","anchor-center-left":"anchor-center-right","bottom-right":"bottom-left"},bottom:{"bottom-left":"top-left","bottom-center":"top-center","anchor-top-center":"anchor-bottom-center","bottom-right":"top-right"},"top-and-left":{"top-left":"bottom-right"},"top-and-right":{"top-right":"bottom-left"},"bottom-and-left":{"bottom-left":"top-right"},"bottom-and-right":{"bottom-right":"top-left"}},e={};let o=null;function n(t,o,n,i){c();const r=document.getElementById("popover-"+t);if(!r)return;r.addEventListener("click",p),r.addEventListener("touchstart",p),r.addEventListener("contextmenu",p),r.focusId=i,r.anchorId=n;const s=n?document.getElementById(n):null;let l=s?s.parentElement:r.parentElement;for(;l&&(!l.contains(r)||"static"==getComputedStyle(l).position);)l=l.parentElement;if(!l)return;r.parent=l,m(r);const f=new MutationObserver(d);f.observe(r,{attributeFilter:["class"]});const a=new ResizeObserver((t=>{for(let e of t){const t=e.target;for(let e=0;e<t.childNodes.length;e++){const o=t.childNodes[e];o instanceof HTMLElement&&o.id&&o.id.startsWith("popover-")&&m(o)}}}));a.observe(l);const h=new ResizeObserver((t=>{for(let e of t){let t=e.target;t instanceof HTMLElement&&m(t)}}));h.observe(r);let g=getComputedStyle(r);const v=/(auto|scroll)/;let b=r.parentElement;for(;b&&!b.listeningForPopoverScroll;)g=getComputedStyle(b),"static"!==g.position?(v.test(g.overflow+g.overflowY+g.overflowX)&&(b.addEventListener("scroll",(()=>{u()})),b.listeningForPopoverScroll=!0),b=b.parentElement):b=b.parentElement;e[t]={anchorId:n,dotNetRef:o,mutationObserver:f,parentResizeObserver:a,resizeObserver:h}}function i(t){const o=e[t];if(o){const n=document.getElementById(`popover-${t}`);n&&(n.removeEventListener("click",p),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",p)),o.resizeObserver.disconnect(),o.mutationObserver.disconnect(),o.parentResizeObserver.disconnect(),delete e[t]}}function r(){for(const t in e)i(t);o&&(o.disconnect(),o=null)}function c(){const t=document.getElementById("main-container");t&&(t.popoverMark||(t.popoverMark="marked",null!=o&&(o.disconnect(),o=null),o=new ResizeObserver((t=>{u()})),o.observe(t)))}function s(t,e,o){const n=document.getElementById("popover-"+t);if(!n)return;const i=n.offsetX,r=n.offsetY;if(n.offsetX=e||void 0,n.offsetY=o||void 0,i||n.offsetX){let t=0;n.style.left&&(t=Number.parseFloat(n.style.left.substr(0,n.style.left.length-2))),i&&(t-=i),n.offsetX&&(t+=n.offsetX),n.style.left=+t.toFixed(2)+"px"}if(r||n.offsetY){let t=0;n.style.top&&(t=Number.parseFloat(n.style.top.substr(0,n.style.top.length-2))),r&&(t-=r),n.offsetY&&(t+=n.offsetY),n.style.top=+t.toFixed(2)+"px"}}function l(t,e,o){const n=document.getElementById("popover-"+t);n&&(n.clientX=e||void 0,n.clientY=o||void 0,n.clientX&&(n.style.left=n.clientX.toFixed(2)+"px"),n.clientY&&(n.style.top=n.clientY.toFixed(2)+"px"))}function f(t,e,o){let n=0,i=0;t.indexOf("anchor-top-left")>=0?(i=0,n=0):t.indexOf("anchor-top-center")>=0?(i=0+e.width/2,n=0):t.indexOf("anchor-top-right")>=0?(i=0+e.width,n=0):t.indexOf("anchor-center-left")>=0?(i=0,n=0+e.height/2):t.indexOf("anchor-center-center")>=0?(i=0+e.width/2,n=0+e.height/2):t.indexOf("anchor-center-right")>=0?(i=0+e.width,n=0+e.height/2):t.indexOf("anchor-bottom-left")>=0?(i=0,n=0+e.height):t.indexOf("anchor-bottom-center")>=0?(i=0+e.width/2,n=0+e.height):t.indexOf("anchor-bottom-right")>=0&&(i=0+e.width,n=0+e.height);let r=0,c=0;return t.indexOf("top-left")>=0?(r=0,c=0):t.indexOf("top-center")>=0?(r=-o.width/2,c=0):t.indexOf("top-right")>=0?(r=-o.width,c=0):t.indexOf("center-left")>=0?(r=0,c=-o.height/2):t.indexOf("center-center")>=0?(r=-o.width/2,c=-o.height/2):t.indexOf("center-right")>=0?(r=-o.width,c=-o.height/2):t.indexOf("bottom-left")>=0?(r=0,c=-o.height):t.indexOf("bottom-center")>=0?(r=-o.width/2,c=-o.height):t.indexOf("bottom-right")>=0&&(r=-o.width,c=-o.height),{top:n,left:i,offsetX:r,offsetY:c}}function d(t){for(const e of t)if("attributes"===e.type&&e.target instanceof HTMLElement){const t=e.target;t.classList.contains("flip-onopen")&&0==t.classList.contains("open")&&(t.popoverFlipped=null,t.removeAttribute("data-popover-flip")),m(t)}}function p(t){const o=[];if(t.target instanceof Element){let e=t.target.closest(".popover");for(;e;)o.push(e.id),e=e.parentElement?.closest(".popover")}if(o.length)for(const t of o){const o=t.substr(8),{focusTimer:n}=e[o];n&&(clearTimeout(n),delete e[o].focusTimer)}}function a(t,o){const n=[];if(o.target instanceof Element){let r=o.target.closest(".popover");if(!r&&t)for(var i in e){const t=`popover-${i}`,e=document.getElementById(t);if(e&&e.focusId){o.target.closest(`#${e.focusId}`)&&n.unshift(t)}}else for(;r;)n.unshift(r.id),r=r.parentElement?.closest(".popover");if(0==n.length){const t=o.target.querySelector(".popover");t&&t.focusId==o.target.id&&n.unshift(t.id)}}for(var i in e){const r=`popover-${i}`,c=document.getElementById(r);if(!c||!c.classList.contains("open"))continue;const{dotNetRef:s,focusTimer:l}=e[i],f=-1!=n.indexOf(r);if(t){if(f){l&&(clearTimeout(l),delete e[i].focusTimer,setTimeout((()=>{clearTimeout(l),delete e[i].focusTimer}),100));continue}}else if(f&&o.relatedTarget instanceof Element){const t=o.relatedTarget.closest(".popover");if(t&&t.id==r)continue}s&&(e[i].focusTimer=setTimeout((t=>{t.invokeMethodAsync("OnFocusLeft")}),150,s))}}function h(t){if(!t)return document.documentElement;for(;t.parentElement;){if("HTML"==(t=t.parentElement).nodeName)return t;const e=window.getComputedStyle(t);if("none"!=e.transform||"none"!=e.perspective||"transform"==e.willChange||"perspective"==e.willChange||"filter"==e.willChange||"none"!=e.filter||"paint"==e.contain||"none"!=e.getPropertyValue("backdrop-filter"))return t}return document.documentElement}function m(e){if(!e||!e.classList.contains("open"))return;const o=h(e),n=o.getBoundingClientRect(),i=e.anchorId,r=i?document.getElementById(i):null,c=r?r.getBoundingClientRect():null,s=r?c:e.parent?e.parent.getBoundingClientRect():n;e.classList.contains("match-width")&&(e.style.minWidth=s.width+"px"),e.classList.contains("limit-width")&&(e.style.maxWidth=s.width+"px");const l=e.getBoundingClientRect(),d=e.classList,p=Array.from(e.classList),a=f(p,s,l);let m=a.left,u=a.top,g=a.offsetX,v=a.offsetY;if(d.contains("flip-onopen")||d.contains("flip-always")){let i=s.left+m,c=s.top+u;if(e.clientX&&e.clientY)i=e.clientX+m,c=e.clientY+u;else if(r){const t=h(r);if(t!=r.parentElement){const e=t.getBoundingClientRect();i+=e.left,c+=e.top}}else e.parent&&o!=e.parent&&(i+=n.left,c+=n.top);const a=i+g,b=window.innerWidth-i-l.width,w=c-l.height,E=c,x=window.innerHeight-c-l.height;let y=e.popoverFlipped;if(y||(d.contains("top-left")?x<0&&b<0&&E>=l.height&&a>=l.width?y="top-and-left":x<0&&E>=l.height?y="top":b<0&&a>=l.width&&(y="left"):d.contains("top-center")?x<0&&E>=l.height&&(y="top"):d.contains("top-right")?x<0&&a<0&&E>=l.height&&b>=l.width?y="top-and-right":x<0&&E>=l.height?y="top":a<0&&b>=l.width&&(y="right"):d.contains("center-left")?b<0&&a>=l.width&&(y="left"):d.contains("center-right")?a<0&&b>=l.width&&(y="right"):d.contains("bottom-left")?w<0&&b<0&&x>=0&&a>=l.width?y="bottom-and-left":w<0&&x>=0?y="bottom":b<0&&a>=l.width&&(y="left"):d.contains("bottom-center")?w<0&&x>=0&&(y="bottom"):d.contains("bottom-right")&&(w<0&&a<0&&x>=0&&b>=l.width?y="bottom-and-right":w<0&&x>=0?y="bottom":a<0&&b>=l.width&&(y="right"))),y&&"none"!=y){const o=function(e,o,n,i){const r=[];for(let n=0;n<e.length;n++){const i=e[n],c=t[o][i];c?r.push(c):r.push(i)}return f(r,n,i)}(p,y,s,l);m=o.left,u=o.top,g=o.offsetX,v=o.offsetY,e.setAttribute("data-popover-flip","flipped")}else e.removeAttribute("data-popover-flip");d.contains("flip-onopen")&&!e.popoverFlipped&&(e.popoverFlipped=y||"none")}e.clientX&&e.clientY?(g+=e.clientX,v+=e.clientY):(g+=s.left-n.left,v+=s.top-n.top),e.offsetX&&(g+=e.offsetX),e.offsetY&&(v+=e.offsetY),e.style.left=m+g+"px",e.style.top=u+v+"px"}function u(){var t=function(){const t=[];for(const o in e)t.push(o);return t}();for(let e=0;e<t.length;e++){const o=document.getElementById("popover-"+t[e]);o&&m(o)}}document.addEventListener("focusin",a.bind(void 0,!0)),document.addEventListener("focusout",a.bind(void 0,!1)),window.addEventListener("resize",(()=>{u()}));export{n as popoverConnect,i as popoverDisconnect,r as popoverDispose,c as popoverInitialize,s as setPopoverOffset,l as setPopoverPosition};
//# sourceMappingURL=tavenem-popover.js.map
