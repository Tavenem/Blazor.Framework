{
  "version": 3,
  "sources": ["../../../../../src/assets/scripts/tavenem-utility.ts"],
  "sourcesContent": ["\uFEFF/// <reference types=\"./../node_modules/@types/blazor__javascript-interop\" />\n\ninterface IFocusableElement extends HTMLElement {\n    savedFocus?: IFocusableElement | undefined | null;\n}\n\ninterface IBoundingClientRect extends DOMRect {\n    scrollY: number;\n    scrollX: number;\n    windowHeight: number;\n    windowWidth: number;\n}\n\ninterface DotNetStreamReference {\n    arrayBuffer(): Promise<ArrayBuffer>;\n}\n\nexport function documentPositionComparator(a: Node, b: Node) {\n    if (a === b) {\n        return 0;\n    }\n\n    var position = a.compareDocumentPosition(b);\n\n    if (position & Node.DOCUMENT_POSITION_FOLLOWING || position & Node.DOCUMENT_POSITION_CONTAINED_BY) {\n        return -1;\n    } else if (position & Node.DOCUMENT_POSITION_PRECEDING || position & Node.DOCUMENT_POSITION_CONTAINS) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\nexport async function downloadStream(fileName: string, fileType: string, streamReference: DotNetStreamReference) {\n    const buffer = await streamReference.arrayBuffer();\n    const file = new File([buffer], fileName, { type: fileType });\n    const url = URL.createObjectURL(file);\n    downloadUrl(fileName, url);\n    URL.revokeObjectURL(url);\n}\n\nexport function downloadUrl(fileName: string, url: string, open?: boolean) {\n    const anchor = document.createElement('a');\n    anchor.href = url;\n    anchor.target = \"_blank\";\n    if (!open) {\n        anchor.download = fileName ?? '';\n    }\n    anchor.click();\n    anchor.remove();\n}\n\nexport function focusFirstElement(element: HTMLElement, skip = 0, min = 0) {\n    if (element) {\n        const tabbables = getTabbableElements(element);\n        if (tabbables.length <= min) {\n            element.focus();\n        } else if (tabbables.length <= skip) {\n            const tabbable = tabbables[tabbables.length - 1];\n            if (tabbable instanceof HTMLElement) {\n                tabbable.focus();\n            }\n        } else {\n            const tabbable = tabbables[skip];\n            if (tabbable instanceof HTMLElement) {\n                tabbable.focus();\n            }\n        }\n    }\n}\n\nexport function focusLastElement(element: HTMLElement, skip = 0, min = 0) {\n    if (element) {\n        const tabbables = getTabbableElements(element);\n        if (tabbables.length <= min) {\n            element.focus();\n        } else if (tabbables.length - skip - 1 < 0) {\n            const tabbable = tabbables[0];\n            if (tabbable instanceof HTMLElement) {\n                tabbable.focus();\n            }\n        } else {\n            const tabbable = tabbables[tabbables.length - skip - 1];\n            if (tabbable instanceof HTMLElement) {\n                tabbable.focus();\n            }\n        }\n    }\n}\n\nexport function getBoundingClientRect(element: HTMLElement) {\n    if (!element) {\n        return;\n    }\n\n    const rect: IBoundingClientRect = JSON.parse(JSON.stringify(element.getBoundingClientRect()));\n\n    rect.scrollY = window.scrollY || document.documentElement.scrollTop;\n    rect.scrollX = window.scrollX || document.documentElement.scrollLeft;\n\n    rect.windowHeight = window.innerHeight;\n    rect.windowWidth = window.innerWidth;\n    return rect;\n}\n\nexport async function openStream(fileName: string, fileType: string, streamReference: DotNetStreamReference, revoke: boolean) {\n    const buffer = await streamReference.arrayBuffer();\n    const file = new File([buffer], fileName, { type: fileType });\n    const url = URL.createObjectURL(file);\n    downloadUrl(fileName, url, true);\n    if (revoke) {\n        URL.revokeObjectURL(url);\n        return '';\n    } else {\n        return url;\n    }\n}\n\nexport function randomUUID() {\n    if (window.isSecureContext) {\n        return crypto.randomUUID();\n    }\n    return \"10000000-1000-4000-8000-100000000000\".replace(/[018]/g, c =>\n        (+c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> +c / 4).toString(16)\n    );\n}\n\nexport function restoreElementFocus(element: IFocusableElement) {\n    if (element) {\n        const previous = element.savedFocus;\n        delete element.savedFocus;\n        if (previous) {\n            previous.focus();\n        }\n    }\n}\n\nexport function saveElementFocus(element: IFocusableElement) {\n    if (element && document.activeElement instanceof HTMLElement) {\n        element.savedFocus = document.activeElement;\n    }\n}\n\nexport function select(element: HTMLInputElement) {\n    if (element) {\n        element.select();\n    }\n}\n\nexport function selectRange(element: HTMLInputElement, start: number, end: number | null) {\n    if (element) {\n        if (element.setSelectionRange) {\n            element.setSelectionRange(start, end);\n        } else if (element.selectionStart) {\n            element.selectionStart = start;\n            element.selectionEnd = end;\n        }\n        element.focus();\n    }\n}\n\nexport function shake(elementId: string | null) {\n    if (!elementId) {\n        return;\n    }\n    const element = document.getElementById(elementId);\n    if (!element || element.classList.contains('shake')) {\n        return;\n    }\n\n    element.classList.add('shake');\n    setTimeout(() => element.classList.remove('shake'), 1000);\n}\n\nfunction getTabbableElements(element: HTMLElement) {\n    return element.querySelectorAll(\n        \"a[href]:not([tabindex='-1']),\" +\n        \"area[href]:not([tabindex='-1']),\" +\n        \"button:not([disabled]):not([tabindex='-1']),\" +\n        \"input:not([disabled]):not([tabindex='-1']):not([type='hidden']):not([hidden]),\" +\n        \"select:not([disabled]):not([tabindex='-1']),\" +\n        \"textarea:not([disabled]):not([tabindex='-1']),\" +\n        \"iframe:not([tabindex='-1']),\" +\n        \"details:not([tabindex='-1']),\" +\n        \"[tabindex]:not([tabindex='-1']),\" +\n        \"[contentEditable=true]:not([tabindex='-1']\"\n    );\n}\n"],
  "mappings": "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",
  "names": ["documentPositionComparator", "a", "b", "position", "downloadStream", "fileName", "fileType", "streamReference", "buffer", "file", "url", "downloadUrl", "open", "anchor", "focusFirstElement", "element", "skip", "min", "tabbables", "getTabbableElements", "tabbable", "focusLastElement", "getBoundingClientRect", "rect", "openStream", "revoke", "randomUUID", "c", "restoreElementFocus", "previous", "saveElementFocus", "select", "selectRange", "start", "end", "shake", "elementId"]
}
